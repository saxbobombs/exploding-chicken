(()=>{"use strict";const t=new function(){this.fps=60},e=function(){function t(){}return t.getRandom=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},t}(),n=function(){function e(){this._tickCounter=1,e._viewCounter++,this._viewId=e._viewCounter.toString()}return e.prototype.tick=function(){this._tickCounter++,this._tickCounter>t.fps&&(this._tickCounter=1)},e._viewCounter=0,e}();var i,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});const o=function(t){function n(n){var i=t.call(this)||this;i.sprite=document.getElementById("chicken"),i.helperCanvas=document.createElement("canvas"),i.sprites={right:[[66,22],[98,22],[130,24],[162,24]],left:[[64,90],[96,89],[128,88],[160,88]],explosion:[[240,22],[205,22],[23,87],[23,56],[23,20]]},i.path=[],i.exploding=!1,i.helperCanvas.width=n.width,i.helperCanvas.height=n.height,i.screen=n.screen,i.helperContext=i.helperCanvas.getContext("2d"),i.currentSpritePos=0;var r=i.screen.getBorders();return i.currentPathX=e.getRandom(0,r.right-i.helperCanvas.width),i.currentPathY=e.getRandom(0,r.bottom-i.helperCanvas.height),i}return r(n,t),n.prototype._createPath=function(t,n){var i=this.currentPathX,r=this.currentPathY;this.directionX=!1!==t?t:e.getRandom(-1,1),this.directionY=!1!==n?n:e.getRandom(-1,1);for(var o=0;o<e.getRandom(1,1e3);o++){var h=i+o*this.directionX,s=r+o*this.directionY;this.path.push({x:h,y:s})}},n.prototype._getPath=function(){var t=this.screen.getBorders();0==this.path.length&&this._createPath(!1,!1);var n=this.path.shift(),i=!1,r=!1;return n.x<t.left&&(i=e.getRandom(0,1)),n.x+this.helperCanvas.width>t.right&&(i=e.getRandom(-1,0)),n.y<t.top&&(r=e.getRandom(0,1)),n.y+this.helperCanvas.height>t.bottom&&(r=e.getRandom(-1,0)),!1===i&&!1===r||(this.path=[],this._createPath(i,r),n=this.path.shift()),n},n.prototype.tick=function(){t.prototype.tick.call(this),this._tickCounter%10==0&&this.currentSpritePos++,this.exploding?this.currentSpritePos>=5&&(this.currentSpritePos=0):this.currentSpritePos>=4&&(this.currentSpritePos=0)},n.prototype._drawChicken=function(){var t;return t=this.directionX>=0?this.sprites.right[this.currentSpritePos]:this.sprites.left[this.currentSpritePos],this.exploding&&(t=this.sprites.explosion[this.currentSpritePos]),this.helperContext.clearRect(0,0,this.helperCanvas.width,this.helperCanvas.height),this.helperContext.drawImage(this.sprite,-1*t[0],-1*t[1]),this.helperCanvas},n.prototype.explode=function(){this.currentSpritePos=0,this.exploding=!0},n.prototype.get=function(){var t=this._drawChicken(),e=this._getPath();return this.exploding||(this.currentPathX=e.x,this.currentPathY=e.y),(!this.exploding||4!=this.currentSpritePos)&&{img:t,x:this.currentPathX,y:this.currentPathY,width:this.helperCanvas.width,height:this.helperCanvas.height}},n}(n);var h=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();const s=function(t){function e(e,n,i){var r=t.call(this)||this;return r.chickens=[],r.canvas=document.createElement("canvas"),r.canvas.height=e,r.canvas.width=n,r.context=r.canvas.getContext("2d"),r.canvas.addEventListener("mousedown",(function(t){return r.hunt(t)})),i.appendChild(r.get()),r}return h(e,t),e.prototype.clear=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},e.prototype.insert=function(t){this.chickens.push(t)},e.prototype.tick=function(){for(var t=[],e=0;e<this.chickens.length;e++){var n=this.chickens[e];n.tick();var i=n.get();!1!==i?this.context.drawImage(i.img,i.x,i.y):t.push(e)}this.chickens=this.chickens.filter((function(e,n){return-1==t.indexOf(n)}))},e.prototype.getBorders=function(){return{top:0,left:0,bottom:this.canvas.height,right:this.canvas.width}},e.prototype.get=function(){return this.canvas},e.prototype.hunt=function(t){for(var e=t.pageX,n=t.pageY,i=0;i<this.chickens.length;i++){var r=this.chickens[i],o=r.get();if(o){var h=!1,s=!1;if(o.x<e&&o.x+o.width>e&&(h=!0),o.y<n&&o.y+o.height>n&&(s=!0),h&&s){r.explode();break}}}},e}(n);var c;function a(){setTimeout((function(){requestAnimationFrame(a),c.clear(),c.tick()}),1e3/t.fps)}window.addEventListener("load",(function(){c=new s(500,500,document.body),function(t){for(var e=0;e<10;e++)c.insert(new o({width:31,height:31,screen:c}))}(),a()}),!1)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leHBsb2RpbmctY2hpY2tlbi8uL3NyYy90cy9jZmcvY2ZnLnRzIiwid2VicGFjazovL2V4cGxvZGluZy1jaGlja2VuLy4vc3JjL3RzL3V0aWxzL3V0aWxzLnRzIiwid2VicGFjazovL2V4cGxvZGluZy1jaGlja2VuLy4vc3JjL3RzL3ZpZXcvYWJzdHJhY3RWaWV3LnRzIiwid2VicGFjazovL2V4cGxvZGluZy1jaGlja2VuLy4vc3JjL3RzL3ZpZXcvY2hpY2tlbi50cyIsIndlYnBhY2s6Ly9leHBsb2RpbmctY2hpY2tlbi8uL3NyYy90cy92aWV3L3NjcmVlbi50cyIsIndlYnBhY2s6Ly9leHBsb2RpbmctY2hpY2tlbi8uL3NyYy90cy9tYWluLnRzIl0sIm5hbWVzIjpbInRoaXMiLCJmcHMiLCJVdGlscyIsImdldFJhbmRvbSIsIm1pbiIsIm1heCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImFic3RyYWN0VmlldyIsIl90aWNrQ291bnRlciIsIl92aWV3Q291bnRlciIsIl92aWV3SWQiLCJ0b1N0cmluZyIsInByb3RvdHlwZSIsInRpY2siLCJleHRlbmRTdGF0aWNzIiwiX19leHRlbmRzIiwiZCIsImIiLCJPYmplY3QiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsIkFycmF5IiwicCIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIl9fIiwiY29uc3RydWN0b3IiLCJjcmVhdGUiLCJfc3VwZXIiLCJjaGlja2VuIiwicENvbmZpZyIsIl90aGlzIiwic3ByaXRlIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImhlbHBlckNhbnZhcyIsImNyZWF0ZUVsZW1lbnQiLCJzcHJpdGVzIiwicmlnaHQiLCJsZWZ0IiwiZXhwbG9zaW9uIiwicGF0aCIsImV4cGxvZGluZyIsIndpZHRoIiwiaGVpZ2h0Iiwic2NyZWVuIiwiaGVscGVyQ29udGV4dCIsImdldENvbnRleHQiLCJjdXJyZW50U3ByaXRlUG9zIiwiX2JvcmRlcnMiLCJnZXRCb3JkZXJzIiwiY3VycmVudFBhdGhYIiwiY3VycmVudFBhdGhZIiwiYm90dG9tIiwiX2NyZWF0ZVBhdGgiLCJwRm9yY2VEaXJlY3Rpb25YIiwicEZvcmNlRGlyZWN0aW9uWSIsIl9wb3NTdGFydFgiLCJfcG9zU3RhcnRZIiwiZGlyZWN0aW9uWCIsImRpcmVjdGlvblkiLCJfaSIsIl9uZXh0WCIsIl9uZXh0WSIsInB1c2giLCJ4IiwieSIsIl9nZXRQYXRoIiwibGVuZ3RoIiwiX25leHRTdGVwIiwic2hpZnQiLCJfZm9yY2VYIiwiX2ZvcmNlWSIsInRvcCIsIl9kcmF3Q2hpY2tlbiIsIl9zcHJpdGUiLCJjbGVhclJlY3QiLCJkcmF3SW1hZ2UiLCJleHBsb2RlIiwiZ2V0IiwiX2NoaWNrZW4iLCJfcGF0aCIsImltZyIsIlNjcmVlbiIsInBXaWR0aCIsInBIZWlnaHQiLCJwU2NyZWVuRGVzdCIsImNoaWNrZW5zIiwiY2FudmFzIiwiY29udGV4dCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiaHVudCIsImFwcGVuZENoaWxkIiwiY2xlYXIiLCJpbnNlcnQiLCJwQ2hpY2tlbiIsIl9jaGlja2Vuc1RvUmVtb3ZlIiwiX2NoaWNrZW5DZmciLCJmaWx0ZXIiLCJ2YWx1ZSIsImluZGV4IiwiaW5kZXhPZiIsInBFdmVudCIsIl9wb3NYIiwicGFnZVgiLCJfcG9zWSIsInBhZ2VZIiwiX2hvcml6b250YWxNYXRjaCIsIl92ZXJ0aWNhbE1hdGNoIiwibG9vcCIsInNldFRpbWVvdXQiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJ3aW5kb3ciLCJib2R5IiwicEFtb3VudCIsInNwYXduQ2hpY2tlbiJdLCJtYXBwaW5ncyI6Im1CQUNBLFlBQ0ksV0FDSUEsS0FBS0MsSUFBTSxJQ1duQixFQWQyQixXQUN2QixTQUFTQyxLQVdULE9BSEFBLEVBQU1DLFVBQVksU0FBVUMsRUFBS0MsR0FDN0IsT0FBT0MsS0FBS0MsTUFBTUQsS0FBS0UsVUFBWUgsRUFBTUQsRUFBTSxHQUFLQSxJQUVqREYsRUFaZSxHQ21CMUIsRUFsQmtDLFdBQzlC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QU81QyxPQUNwQk4sTUFBT3hDLEtBQUswRixPQUFPN0MsUUFHM0J3QyxFQUFPdkUsVUFBVW1FLElBQU0sV0FDbkIsT0FBT2pGLEtBQUswRixRQUVoQkwsRUFBT3ZFLFVBQVVnRixLQUFPLFNBQVVXLEdBRTlCLElBREEsSUFBSUMsRUFBUUQsRUFBT0UsTUFBT0MsRUFBUUgsRUFBT0ksTUFDaEM5QyxFQUFLLEVBQUdBLEVBQUsvRCxLQUFLeUYsU0FBU25CLE9BQVFQLElBQU0sQ0FDOUMsSUFBSW1CLEVBQVdsRixLQUFLeUYsU0FBUzFCLEdBQUtxQyxFQUFjbEIsRUFBU0QsTUFDekQsR0FBS21CLEVBQUwsQ0FHQSxJQUFJVSxHQUFtQixFQUFPQyxHQUFpQixFQU8vQyxHQU5JWCxFQUFZakMsRUFBSXVDLEdBQVNOLEVBQVlqQyxFQUFJaUMsRUFBWXZELE1BQVE2RCxJQUM3REksR0FBbUIsR0FFbkJWLEVBQVloQyxFQUFJd0MsR0FBU1IsRUFBWWhDLEVBQUlnQyxFQUFZdEQsT0FBUzhELElBQzlERyxHQUFpQixHQUVqQkQsR0FBb0JDLEVBQWdCLENBQ3BDN0IsRUFBU0YsVUFDVCxVQUlMSyxFQTlFZ0IsQ0ErRXpCLEdDMUZGLElBQ0ksRUFlSixTQUFTMkIsSUFDTEMsWUFBVyxXQUNQQyxzQkFBc0JGLEdBQ3RCLEVBQU9oQixRQUNQLEVBQU9qRixTQUNSLElBQU8sT0FFZG9HLE9BQU92QixpQkFBaUIsUUFyQmIsV0FDUCxFQUFTLElBQUksRUFBTyxJQUFLLElBQUt6RCxTQUFTaUYsTUFJM0MsU0FBc0JDLEdBQ2xCLElBQUssSUFBSXRELEVBQUssRUFBR0EsRUFKSixHQUlrQkEsSUFDM0IsRUFBT2tDLE9BQU8sSUFBSSxFQUFRLENBQ3RCcEQsTUFWSyxHQVdMQyxPQVhLLEdBWUxDLE9BQVEsS0FSaEJ1RSxHQUNBTixPQWtCa0MsSSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gdG9kbzogcHJvcGVyIHNpbmdsZXRvbj9cclxuZXhwb3J0IGRlZmF1bHQgbmV3IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIGNmZygpIHtcclxuICAgICAgICB0aGlzLmZwcyA9IDYwO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNmZztcclxufSgpKTtcclxuIiwidmFyIFV0aWxzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gVXRpbHMoKSB7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIGdlbmVyYXRlIGEgcmFuZG9tIG51bWJlciBiZXR3ZWVuIG1pbiBhbmQgbWF4XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIG1pblxyXG4gICAgICogQHBhcmFtIG1heFxyXG4gICAgICovXHJcbiAgICBVdGlscy5nZXRSYW5kb20gPSBmdW5jdGlvbiAobWluLCBtYXgpIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiArIDEpICsgbWluKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gVXRpbHM7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IFV0aWxzO1xyXG4iLCJpbXBvcnQgQ2ZnIGZyb20gJy4uL2NmZy9jZmcnO1xyXG52YXIgYWJzdHJhY3RWaWV3ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gYWJzdHJhY3RWaWV3KCkge1xyXG4gICAgICAgIHRoaXMuX3RpY2tDb3VudGVyID0gMTtcclxuICAgICAgICBhYnN0cmFjdFZpZXcuX3ZpZXdDb3VudGVyKys7XHJcbiAgICAgICAgdGhpcy5fdmlld0lkID0gYWJzdHJhY3RWaWV3Ll92aWV3Q291bnRlci50b1N0cmluZygpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBmcmFtZSBkcmF3IHVwZGF0ZVxyXG4gICAgICovXHJcbiAgICBhYnN0cmFjdFZpZXcucHJvdG90eXBlLnRpY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5fdGlja0NvdW50ZXIrKztcclxuICAgICAgICBpZiAodGhpcy5fdGlja0NvdW50ZXIgPiBDZmcuZnBzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RpY2tDb3VudGVyID0gMTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgYWJzdHJhY3RWaWV3Ll92aWV3Q291bnRlciA9IDA7XHJcbiAgICByZXR1cm4gYWJzdHJhY3RWaWV3O1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBhYnN0cmFjdFZpZXc7XHJcbiIsInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbmltcG9ydCBVdGlscyBmcm9tICcuLi91dGlscy91dGlscyc7XHJcbmltcG9ydCBBYnN0cmFjdFZpZXcgZnJvbSAnLi9hYnN0cmFjdFZpZXcnO1xyXG52YXIgY2hpY2tlbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIF9fZXh0ZW5kcyhjaGlja2VuLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gY2hpY2tlbihwQ29uZmlnKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICAvLyBmb3Igbm93XHJcbiAgICAgICAgX3RoaXMuc3ByaXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NoaWNrZW4nKTtcclxuICAgICAgICBfdGhpcy5oZWxwZXJDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcclxuICAgICAgICBfdGhpcy5zcHJpdGVzID0ge1xyXG4gICAgICAgICAgICByaWdodDogW1xyXG4gICAgICAgICAgICAgICAgWzY2LCAyMl0sXHJcbiAgICAgICAgICAgICAgICBbOTgsIDIyXSxcclxuICAgICAgICAgICAgICAgIFsxMzAsIDI0XSxcclxuICAgICAgICAgICAgICAgIFsxNjIsIDI0XVxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICBsZWZ0OiBbXHJcbiAgICAgICAgICAgICAgICBbNjQsIDkwXSxcclxuICAgICAgICAgICAgICAgIFs5NiwgODldLFxyXG4gICAgICAgICAgICAgICAgWzEyOCwgODhdLFxyXG4gICAgICAgICAgICAgICAgWzE2MCwgODhdXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIGV4cGxvc2lvbjogW1xyXG4gICAgICAgICAgICAgICAgWzI0MCwgMjJdLFxyXG4gICAgICAgICAgICAgICAgWzIwNSwgMjJdLFxyXG4gICAgICAgICAgICAgICAgWzIzLCA4N10sXHJcbiAgICAgICAgICAgICAgICBbMjMsIDU2XSxcclxuICAgICAgICAgICAgICAgIFsyMywgMjBdXHJcbiAgICAgICAgICAgIF1cclxuICAgICAgICB9O1xyXG4gICAgICAgIF90aGlzLnBhdGggPSBbXTtcclxuICAgICAgICBfdGhpcy5leHBsb2RpbmcgPSBmYWxzZTtcclxuICAgICAgICBfdGhpcy5oZWxwZXJDYW52YXMud2lkdGggPSBwQ29uZmlnLndpZHRoO1xyXG4gICAgICAgIF90aGlzLmhlbHBlckNhbnZhcy5oZWlnaHQgPSBwQ29uZmlnLmhlaWdodDtcclxuICAgICAgICBfdGhpcy5zY3JlZW4gPSBwQ29uZmlnLnNjcmVlbjtcclxuICAgICAgICBfdGhpcy5oZWxwZXJDb250ZXh0ID0gX3RoaXMuaGVscGVyQ2FudmFzLmdldENvbnRleHQoJzJkJyk7XHJcbiAgICAgICAgX3RoaXMuY3VycmVudFNwcml0ZVBvcyA9IDA7XHJcbiAgICAgICAgdmFyIF9ib3JkZXJzID0gX3RoaXMuc2NyZWVuLmdldEJvcmRlcnMoKTtcclxuICAgICAgICBfdGhpcy5jdXJyZW50UGF0aFggPSBVdGlscy5nZXRSYW5kb20oMCwgX2JvcmRlcnMucmlnaHQgLSBfdGhpcy5oZWxwZXJDYW52YXMud2lkdGgpO1xyXG4gICAgICAgIF90aGlzLmN1cnJlbnRQYXRoWSA9IFV0aWxzLmdldFJhbmRvbSgwLCBfYm9yZGVycy5ib3R0b20gLSBfdGhpcy5oZWxwZXJDYW52YXMuaGVpZ2h0KTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIGdlbmVyYXRlIHRoZSByb3V0ZVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwRm9yY2VEaXJlY3Rpb25YIDF8MHwtMXxmYWxzZVxyXG4gICAgICogQHBhcmFtIHBGb3JjZURpcmVjdGlvblkgMXwwfC0xfGZhbHNlXHJcbiAgICAgKi9cclxuICAgIGNoaWNrZW4ucHJvdG90eXBlLl9jcmVhdGVQYXRoID0gZnVuY3Rpb24gKHBGb3JjZURpcmVjdGlvblgsIHBGb3JjZURpcmVjdGlvblkpIHtcclxuICAgICAgICB2YXIgX3Bvc1N0YXJ0WCA9IHRoaXMuY3VycmVudFBhdGhYLCBfcG9zU3RhcnRZID0gdGhpcy5jdXJyZW50UGF0aFk7XHJcbiAgICAgICAgdGhpcy5kaXJlY3Rpb25YID0gKHBGb3JjZURpcmVjdGlvblggIT09IGZhbHNlKSA/IHBGb3JjZURpcmVjdGlvblggOiBVdGlscy5nZXRSYW5kb20oLTEsIDEpO1xyXG4gICAgICAgIHRoaXMuZGlyZWN0aW9uWSA9IChwRm9yY2VEaXJlY3Rpb25ZICE9PSBmYWxzZSkgPyBwRm9yY2VEaXJlY3Rpb25ZIDogVXRpbHMuZ2V0UmFuZG9tKC0xLCAxKTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgVXRpbHMuZ2V0UmFuZG9tKDEsIDEwMDApOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBfbmV4dFggPSBfcG9zU3RhcnRYICsgKF9pICogdGhpcy5kaXJlY3Rpb25YKSwgX25leHRZID0gX3Bvc1N0YXJ0WSArIChfaSAqIHRoaXMuZGlyZWN0aW9uWSk7XHJcbiAgICAgICAgICAgIHRoaXMucGF0aC5wdXNoKHtcclxuICAgICAgICAgICAgICAgIHg6IF9uZXh0WCxcclxuICAgICAgICAgICAgICAgIHk6IF9uZXh0WSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogZ2V0IG5leHQgcGF0aCBzdGVwXHJcbiAgICAgKlxyXG4gICAgICogY2hlY2sgaWYgdGhlIHN0ZXAgaXMgcG9zc2libGVcclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJuIHtzdGVwfVxyXG4gICAgICovXHJcbiAgICBjaGlja2VuLnByb3RvdHlwZS5fZ2V0UGF0aCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX2JvcmRlcnMgPSB0aGlzLnNjcmVlbi5nZXRCb3JkZXJzKCk7XHJcbiAgICAgICAgaWYgKHRoaXMucGF0aC5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLl9jcmVhdGVQYXRoKGZhbHNlLCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBfbmV4dFN0ZXAgPSB0aGlzLnBhdGguc2hpZnQoKTtcclxuICAgICAgICB2YXIgX2ZvcmNlWCA9IGZhbHNlLCBfZm9yY2VZID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKF9uZXh0U3RlcC54IDwgX2JvcmRlcnMubGVmdCkge1xyXG4gICAgICAgICAgICBfZm9yY2VYID0gVXRpbHMuZ2V0UmFuZG9tKDAsIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoX25leHRTdGVwLnggKyB0aGlzLmhlbHBlckNhbnZhcy53aWR0aCA+IF9ib3JkZXJzLnJpZ2h0KSB7XHJcbiAgICAgICAgICAgIF9mb3JjZVggPSBVdGlscy5nZXRSYW5kb20oLTEsIDApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoX25leHRTdGVwLnkgPCBfYm9yZGVycy50b3ApIHtcclxuICAgICAgICAgICAgX2ZvcmNlWSA9IFV0aWxzLmdldFJhbmRvbSgwLCAxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKF9uZXh0U3RlcC55ICsgdGhpcy5oZWxwZXJDYW52YXMuaGVpZ2h0ID4gX2JvcmRlcnMuYm90dG9tKSB7XHJcbiAgICAgICAgICAgIF9mb3JjZVkgPSBVdGlscy5nZXRSYW5kb20oLTEsIDApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoX2ZvcmNlWCAhPT0gZmFsc2UgfHwgX2ZvcmNlWSAhPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgdGhpcy5wYXRoID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZVBhdGgoX2ZvcmNlWCwgX2ZvcmNlWSk7XHJcbiAgICAgICAgICAgIF9uZXh0U3RlcCA9IHRoaXMucGF0aC5zaGlmdCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gX25leHRTdGVwO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogZnJhbWUgc3RlcFxyXG4gICAgICovXHJcbiAgICBjaGlja2VuLnByb3RvdHlwZS50aWNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUudGljay5jYWxsKHRoaXMpO1xyXG4gICAgICAgIGlmICh0aGlzLl90aWNrQ291bnRlciAlIDEwID09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U3ByaXRlUG9zKys7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5leHBsb2RpbmcpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFNwcml0ZVBvcyA+PSA0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTcHJpdGVQb3MgPSAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50U3ByaXRlUG9zID49IDUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFNwcml0ZVBvcyA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgY2hpY2tlbi5wcm90b3R5cGUuX2RyYXdDaGlja2VuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfc3ByaXRlO1xyXG4gICAgICAgIGlmICh0aGlzLmRpcmVjdGlvblggPj0gMCkge1xyXG4gICAgICAgICAgICBfc3ByaXRlID0gdGhpcy5zcHJpdGVzLnJpZ2h0W3RoaXMuY3VycmVudFNwcml0ZVBvc107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBfc3ByaXRlID0gdGhpcy5zcHJpdGVzLmxlZnRbdGhpcy5jdXJyZW50U3ByaXRlUG9zXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZXhwbG9kaW5nKSB7XHJcbiAgICAgICAgICAgIF9zcHJpdGUgPSB0aGlzLnNwcml0ZXMuZXhwbG9zaW9uW3RoaXMuY3VycmVudFNwcml0ZVBvc107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaGVscGVyQ29udGV4dC5jbGVhclJlY3QoMCwgMCwgdGhpcy5oZWxwZXJDYW52YXMud2lkdGgsIHRoaXMuaGVscGVyQ2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgdGhpcy5oZWxwZXJDb250ZXh0LmRyYXdJbWFnZSh0aGlzLnNwcml0ZSwgX3Nwcml0ZVswXSAqIC0xLCBfc3ByaXRlWzFdICogLTEpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmhlbHBlckNhbnZhcztcclxuICAgIH07XHJcbiAgICBjaGlja2VuLnByb3RvdHlwZS5leHBsb2RlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY3VycmVudFNwcml0ZVBvcyA9IDA7XHJcbiAgICAgICAgdGhpcy5leHBsb2RpbmcgPSB0cnVlO1xyXG4gICAgfTtcclxuICAgIGNoaWNrZW4ucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX2NoaWNrZW4gPSB0aGlzLl9kcmF3Q2hpY2tlbigpO1xyXG4gICAgICAgIHZhciBfcGF0aCA9IHRoaXMuX2dldFBhdGgoKTtcclxuICAgICAgICBpZiAoIXRoaXMuZXhwbG9kaW5nKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhdGhYID0gX3BhdGgueDtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGF0aFkgPSBfcGF0aC55O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5leHBsb2RpbmcgJiYgdGhpcy5jdXJyZW50U3ByaXRlUG9zID09IDQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpbWc6IF9jaGlja2VuLFxyXG4gICAgICAgICAgICB4OiB0aGlzLmN1cnJlbnRQYXRoWCxcclxuICAgICAgICAgICAgeTogdGhpcy5jdXJyZW50UGF0aFksXHJcbiAgICAgICAgICAgIHdpZHRoOiB0aGlzLmhlbHBlckNhbnZhcy53aWR0aCxcclxuICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLmhlbHBlckNhbnZhcy5oZWlnaHQsXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gY2hpY2tlbjtcclxufShBYnN0cmFjdFZpZXcpKTtcclxuZXhwb3J0IGRlZmF1bHQgY2hpY2tlbjtcclxuO1xyXG4iLCJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XHJcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XHJcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbiAgICB9O1xyXG59KSgpO1xyXG5pbXBvcnQgQWJzdHJhY3RWaWV3IGZyb20gJy4vYWJzdHJhY3RWaWV3JztcclxudmFyIFNjcmVlbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIF9fZXh0ZW5kcyhTY3JlZW4sIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBTY3JlZW4ocFdpZHRoLCBwSGVpZ2h0LCBwU2NyZWVuRGVzdCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuY2hpY2tlbnMgPSBbXTtcclxuICAgICAgICBfdGhpcy5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcclxuICAgICAgICBfdGhpcy5jYW52YXMuaGVpZ2h0ID0gcFdpZHRoO1xyXG4gICAgICAgIF90aGlzLmNhbnZhcy53aWR0aCA9IHBIZWlnaHQ7XHJcbiAgICAgICAgX3RoaXMuY29udGV4dCA9IF90aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG4gICAgICAgIF90aGlzLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBmdW5jdGlvbiAoZSkgeyByZXR1cm4gX3RoaXMuaHVudChlKTsgfSk7XHJcbiAgICAgICAgcFNjcmVlbkRlc3QuYXBwZW5kQ2hpbGQoX3RoaXMuZ2V0KCkpO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogY2xlYXIgc2NyZWVuIGZvciBuZXh0IGRyYXdcclxuICAgICAqL1xyXG4gICAgU2NyZWVuLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogaW5zZXJ0IHRoaW5ncy9jaGlja2VuIHRvIHNjcmVlblxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwQ2hpY2tlbkNmZ1RvSW5zZXJ0XHJcbiAgICAgKi9cclxuICAgIFNjcmVlbi5wcm90b3R5cGUuaW5zZXJ0ID0gZnVuY3Rpb24gKHBDaGlja2VuKSB7XHJcbiAgICAgICAgdGhpcy5jaGlja2Vucy5wdXNoKHBDaGlja2VuKTtcclxuICAgIH07XHJcbiAgICBTY3JlZW4ucHJvdG90eXBlLnRpY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF9jaGlja2Vuc1RvUmVtb3ZlID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IHRoaXMuY2hpY2tlbnMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBfY2hpY2tlbiA9IHRoaXMuY2hpY2tlbnNbX2ldO1xyXG4gICAgICAgICAgICBfY2hpY2tlbi50aWNrKCk7XHJcbiAgICAgICAgICAgIHZhciBfY2hpY2tlbkNmZyA9IF9jaGlja2VuLmdldCgpO1xyXG4gICAgICAgICAgICBpZiAoX2NoaWNrZW5DZmcgIT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHQuZHJhd0ltYWdlKF9jaGlja2VuQ2ZnLmltZywgX2NoaWNrZW5DZmcueCwgX2NoaWNrZW5DZmcueSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBfY2hpY2tlbnNUb1JlbW92ZS5wdXNoKF9pKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoaWNrZW5zID0gdGhpcy5jaGlja2Vucy5maWx0ZXIoZnVuY3Rpb24gKHZhbHVlLCBpbmRleCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX2NoaWNrZW5zVG9SZW1vdmUuaW5kZXhPZihpbmRleCkgPT0gLTE7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKlxyXG4gICAgICovXHJcbiAgICBTY3JlZW4ucHJvdG90eXBlLmdldEJvcmRlcnMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdG9wOiAwLFxyXG4gICAgICAgICAgICBsZWZ0OiAwLFxyXG4gICAgICAgICAgICBib3R0b206IHRoaXMuY2FudmFzLmhlaWdodCxcclxuICAgICAgICAgICAgcmlnaHQ6IHRoaXMuY2FudmFzLndpZHRoXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICBTY3JlZW4ucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jYW52YXM7XHJcbiAgICB9O1xyXG4gICAgU2NyZWVuLnByb3RvdHlwZS5odW50ID0gZnVuY3Rpb24gKHBFdmVudCkge1xyXG4gICAgICAgIHZhciBfcG9zWCA9IHBFdmVudC5wYWdlWCwgX3Bvc1kgPSBwRXZlbnQucGFnZVk7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IHRoaXMuY2hpY2tlbnMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBfY2hpY2tlbiA9IHRoaXMuY2hpY2tlbnNbX2ldLCBfY2hpY2tlbkNmZyA9IF9jaGlja2VuLmdldCgpO1xyXG4gICAgICAgICAgICBpZiAoIV9jaGlja2VuQ2ZnKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgX2hvcml6b250YWxNYXRjaCA9IGZhbHNlLCBfdmVydGljYWxNYXRjaCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpZiAoX2NoaWNrZW5DZmcueCA8IF9wb3NYICYmIF9jaGlja2VuQ2ZnLnggKyBfY2hpY2tlbkNmZy53aWR0aCA+IF9wb3NYKSB7XHJcbiAgICAgICAgICAgICAgICBfaG9yaXpvbnRhbE1hdGNoID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoX2NoaWNrZW5DZmcueSA8IF9wb3NZICYmIF9jaGlja2VuQ2ZnLnkgKyBfY2hpY2tlbkNmZy5oZWlnaHQgPiBfcG9zWSkge1xyXG4gICAgICAgICAgICAgICAgX3ZlcnRpY2FsTWF0Y2ggPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChfaG9yaXpvbnRhbE1hdGNoICYmIF92ZXJ0aWNhbE1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICBfY2hpY2tlbi5leHBsb2RlKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gU2NyZWVuO1xyXG59KEFic3RyYWN0VmlldykpO1xyXG5leHBvcnQgZGVmYXVsdCBTY3JlZW47XHJcbiIsImltcG9ydCBDZmcgZnJvbSAnLi9jZmcvY2ZnJztcclxuaW1wb3J0IENoaWNrZW4gZnJvbSAnLi92aWV3L2NoaWNrZW4nO1xyXG5pbXBvcnQgU2NyZWVuIGZyb20gJy4vdmlldy9zY3JlZW4nO1xyXG52YXIgc3ByaXRlU2l6ZSA9IDMxO1xyXG52YXIgc2NyZWVuO1xyXG52YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHNjcmVlbiA9IG5ldyBTY3JlZW4oNTAwLCA1MDAsIGRvY3VtZW50LmJvZHkpO1xyXG4gICAgc3Bhd25DaGlja2VuKDEwKTtcclxuICAgIGxvb3AoKTtcclxufTtcclxuZnVuY3Rpb24gc3Bhd25DaGlja2VuKHBBbW91bnQpIHtcclxuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBwQW1vdW50OyBfaSsrKSB7XHJcbiAgICAgICAgc2NyZWVuLmluc2VydChuZXcgQ2hpY2tlbih7XHJcbiAgICAgICAgICAgIHdpZHRoOiBzcHJpdGVTaXplLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IHNwcml0ZVNpemUsXHJcbiAgICAgICAgICAgIHNjcmVlbjogc2NyZWVuXHJcbiAgICAgICAgfSkpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGxvb3AoKSB7XHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcCk7XHJcbiAgICAgICAgc2NyZWVuLmNsZWFyKCk7XHJcbiAgICAgICAgc2NyZWVuLnRpY2soKTtcclxuICAgIH0sIDEwMDAgLyBDZmcuZnBzKTtcclxufVxyXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGluaXQsIGZhbHNlKTtcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==