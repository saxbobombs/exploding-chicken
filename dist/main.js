(()=>{"use strict";const t=new function(){this.fps=60},e=function(){function t(){}return t.getRandom=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},t}(),n=function(){function e(){this._tickCounter=1,e._viewCounter++,this._viewId=e._viewCounter.toString()}return e.prototype.tick=function(){this._tickCounter++,this._tickCounter>t.fps&&(this._tickCounter=1)},e._viewCounter=0,e}();var i,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});const o=function(t){function n(n){var i=t.call(this)||this;i.sprite=document.getElementById("chicken"),i.helperCanvas=document.createElement("canvas"),i.sprites={right:[[66,22],[98,22],[130,24],[162,24]],left:[[64,90],[96,89],[128,88],[160,88]],explosion:[[240,22],[205,22],[23,87],[23,56],[23,20]]},i.path=[],i.exploding=!1,i.helperCanvas.width=n.width,i.helperCanvas.height=n.height,i.screen=n.screen,i.helperContext=i.helperCanvas.getContext("2d"),i.currentSpritePos=0;var r=i.screen.getBorders();return i.currentPathX=e.getRandom(0,r.right-i.helperCanvas.width),i.currentPathY=e.getRandom(0,r.bottom-i.helperCanvas.height),i._drawChicken(),i}return r(n,t),n.prototype._createPath=function(t,n){var i=this.currentPathX,r=this.currentPathY;this.directionX=!1!==t?t:e.getRandom(-1,1),this.directionY=!1!==n?n:e.getRandom(-1,1);for(var o=0;o<e.getRandom(1,1e3);o++){var h=i+o*this.directionX,s=r+o*this.directionY;this.path.push({x:h,y:s})}},n.prototype._getPath=function(){var t=this.screen.getBorders();0==this.path.length&&this._createPath(!1,!1);var n=this.path.shift(),i=!1,r=!1;return n.x<t.left&&(i=e.getRandom(0,1)),n.x+this.helperCanvas.width>t.right&&(i=e.getRandom(-1,0)),n.y<t.top&&(r=e.getRandom(0,1)),n.y+this.helperCanvas.height>t.bottom&&(r=e.getRandom(-1,0)),!1===i&&!1===r||(this.path=[],this._createPath(i,r),n=this.path.shift()),n},n.prototype.tick=function(){t.prototype.tick.call(this);var e=!1;this._tickCounter%10==0&&(e=!0,this.currentSpritePos++),this.exploding?this.currentSpritePos>=5&&(this.currentSpritePos=0):this.currentSpritePos>=4&&(this.currentSpritePos=0),e&&this._drawChicken()},n.prototype._drawChicken=function(){var t;t=this.directionX>=0?this.sprites.right[this.currentSpritePos]:this.sprites.left[this.currentSpritePos],this.exploding&&(t=this.sprites.explosion[this.currentSpritePos]),this.helperContext.clearRect(0,0,this.helperCanvas.width,this.helperCanvas.height),this.helperContext.drawImage(this.sprite,-1*t[0],-1*t[1])},n.prototype.explode=function(){this.currentSpritePos=0,this.exploding=!0},n.prototype.get=function(){var t=this.helperCanvas,e=this._getPath();return this.exploding||(this.currentPathX=e.x,this.currentPathY=e.y),(!this.exploding||4!=this.currentSpritePos)&&{img:t,x:this.currentPathX,y:this.currentPathY,width:this.helperCanvas.width,height:this.helperCanvas.height}},n}(n);var h=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();const s=function(t){function e(e,n,i){var r=t.call(this)||this;return r.chickens=[],r.canvas=document.createElement("canvas"),r.canvas.height=e,r.canvas.width=n,r.context=r.canvas.getContext("2d"),r.canvas.addEventListener("mousedown",(function(t){return r.hunt(t)})),i.appendChild(r.get()),r}return h(e,t),e.prototype.clear=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},e.prototype.insert=function(t){this.chickens.push(t)},e.prototype.tick=function(){for(var t=[],e=0;e<this.chickens.length;e++){var n=this.chickens[e];n.tick();var i=n.get();!1!==i?this.context.drawImage(i.img,i.x,i.y):t.push(e)}this.chickens=this.chickens.filter((function(e,n){return-1==t.indexOf(n)}))},e.prototype.getBorders=function(){return{top:0,left:0,bottom:this.canvas.height,right:this.canvas.width}},e.prototype.get=function(){return this.canvas},e.prototype.hunt=function(t){for(var e=t.pageX,n=t.pageY,i=0;i<this.chickens.length;i++){var r=this.chickens[i],o=r.get();if(o){var h=!1,s=!1;if(o.x<e&&o.x+o.width>e&&(h=!0),o.y<n&&o.y+o.height>n&&(s=!0),h&&s){r.explode();break}}}},e}(n);var c;function a(){setTimeout((function(){requestAnimationFrame(a),c.clear(),c.tick()}),1e3/t.fps)}window.addEventListener("load",(function(){c=new s(500,500,document.body),function(t){for(var e=0;e<10;e++)c.insert(new o({width:31,height:31,screen:c}))}(),a()}),!1)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leHBsb2RpbmctY2hpY2tlbi8uL3NyYy90cy9jZmcvY2ZnLnRzIiwid2VicGFjazovL2V4cGxvZGluZy1jaGlja2VuLy4vc3JjL3RzL3V0aWxzL3V0aWxzLnRzIiwid2VicGFjazovL2V4cGxvZGluZy1jaGlja2VuLy4vc3JjL3RzL3ZpZXcvYWJzdHJhY3RWaWV3LnRzIiwid2VicGFjazovL2V4cGxvZGluZy1jaGlja2VuLy4vc3JjL3RzL3ZpZXcvY2hpY2tlbi50cyIsIndlYnBhY2s6Ly9leHBsb2RpbmctY2hpY2tlbi8uL3NyYy90cy92aWV3L3NjcmVlbi50cyIsIndlYnBhY2s6Ly9leHBsb2RpbmctY2hpY2tlbi8uL3NyYy90cy9tYWluLnRzIl0sIm5hbWVzIjpbInRoaXMiLCJmcHMiLCJVdGlscyIsImdldFJhbmRvbSIsIm1pbiIsIm1heCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImFic3RyYWN0VmlldyIsIl90aWNrQ291bnRlciIsIl92aWV3Q291bnRlciIsIl92aWV3SWQiLCJ0b1N0cmluZyIsInByb3RvdHlwZSIsInRpY2siLCJleHRlbmRTdGF0aWNzIiwiX19leHRlbmRzIiwiZCIsImIiLCJPYmplY3QiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsIkFycmF5IiwicCIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIl9fIiwiY29uc3RydWN0b3IiLCJjcmVhdGUiLCJfc3VwZXIiLCJjaGlja2VuIiwicENvbmZpZyIsIl90aGlzIiwic3ByaXRlIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImhlbHBlckNhbnZhcyIsImNyZWF0ZUVsZW1lbnQiLCJzcHJpdGVzIiwicmlnaHQiLCJsZWZ0IiwiZXhwbG9zaW9uIiwicGF0aCIsImV4cGxvZGluZyIsIndpZHRoIiwiaGVpZ2h0Iiwic2NyZWVuIiwiaGVscGVyQ29udGV4dCIsImdldENvbnRleHQiLCJjdXJyZW50U3ByaXRlUG9zIiwiX2JvcmRlcnMiLCJnZXRCb3JkZXJzIiwiY3VycmVudFBhdGhYIiwiY3VycmVudFBhdGhZIiwiYm90dG9tIiwiX2RyYXdDaGlja2VuIiwiX2NyZWF0ZVBhdGgiLCJwRm9yY2VEaXJlY3Rpb25YIiwicEZvcmNlRGlyZWN0aW9uWSIsIl9wb3NTdGFydFgiLCJfcG9zU3RhcnRZIiwiZGlyZWN0aW9uWCIsImRpcmVjdGlvblkiLCJfaSIsIl9uZXh0WCIsIl9uZXh0WSIsInB1c2giLCJ4IiwieSIsIl9nZXRQYXRoIiwibGVuZ3RoIiwiX25leHRTdGVwIiwic2hpZnQiLCJfZm9yY2VYIiwiX2ZvcmNlWSIsInRvcCIsIl9kcmF3IiwiX3Nwcml0ZSIsImNsZWFyUmVjdCIsImRyYXdJbWFnZSIsImV4cGxvZGUiLCJnZXQiLCJfY2hpY2tlbiIsIl9wYXRoIiwiaW1nIiwiU2NyZWVuIiwicFdpZHRoIiwicEhlaWdodCIsInBTY3JlZW5EZXN0IiwiY2hpY2tlbnMiLCJjYW52YXMiLCJjb250ZXh0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJodW50IiwiYXBwZW5kQ2hpbGQiLCJjbGVhciIsImluc2VydCIsInBDaGlja2VuIiwiX2NoaWNrZW5zVG9SZW1vdmUiLCJfY2hpY2tlbkNmZyIsImZpbHRlciIsInZhbHVlIiwiaW5kZXgiLCJpbmRleE9mIiwicEV2ZW50IiwiX3Bvc1giLCJwYWdlWCIsIl9wb3NZIiwicGFnZVkiLCJfaG9yaXpvbnRhbE1hdGNoIiwiX3ZlcnRpY2FsTWF0Y2giLCJsb29wIiwic2V0VGltZW91dCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIndpbmRvdyIsImJvZHkiLCJwQW1vdW50Iiwic3Bhd25DaGlja2VuIl0sIm1hcHBpbmdzIjoibUJBQ0EsWUFDSSxXQUNJQSxLQUFLQyxJQUFNLElDV25CLEVBZDJCLFdBQ3ZCLFNBQVNDLEtBV1QsT0FIQUEsRUFBTUMsVUFBWSxTQUFVQyxFQUFLQyxHQUM3QixPQUFPQyxLQUFLQyxNQUFNRCxLQUFLRSxVQUFZSCxFQUFNRCxFQUFNLEdBQUtBLElBRWpERixFQVplLEdDbUIxQixFQWxC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b2RvOiBwcm9wZXIgc2luZ2xldG9uP1xyXG5leHBvcnQgZGVmYXVsdCBuZXcgLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gY2ZnKCkge1xyXG4gICAgICAgIHRoaXMuZnBzID0gNjA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY2ZnO1xyXG59KCkpO1xyXG4iLCJ2YXIgVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBVdGlscygpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogZ2VuZXJhdGUgYSByYW5kb20gbnVtYmVyIGJldHdlZW4gbWluIGFuZCBtYXhcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbWluXHJcbiAgICAgKiBAcGFyYW0gbWF4XHJcbiAgICAgKi9cclxuICAgIFV0aWxzLmdldFJhbmRvbSA9IGZ1bmN0aW9uIChtaW4sIG1heCkge1xyXG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkgKyBtaW4pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBVdGlscztcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgVXRpbHM7XHJcbiIsImltcG9ydCBDZmcgZnJvbSAnLi4vY2ZnL2NmZyc7XHJcbnZhciBhYnN0cmFjdFZpZXcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBhYnN0cmFjdFZpZXcoKSB7XHJcbiAgICAgICAgdGhpcy5fdGlja0NvdW50ZXIgPSAxO1xyXG4gICAgICAgIGFic3RyYWN0Vmlldy5fdmlld0NvdW50ZXIrKztcclxuICAgICAgICB0aGlzLl92aWV3SWQgPSBhYnN0cmFjdFZpZXcuX3ZpZXdDb3VudGVyLnRvU3RyaW5nKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIGZyYW1lIGRyYXcgdXBkYXRlXHJcbiAgICAgKi9cclxuICAgIGFic3RyYWN0Vmlldy5wcm90b3R5cGUudGljayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl90aWNrQ291bnRlcisrO1xyXG4gICAgICAgIGlmICh0aGlzLl90aWNrQ291bnRlciA+IENmZy5mcHMpIHtcclxuICAgICAgICAgICAgdGhpcy5fdGlja0NvdW50ZXIgPSAxO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBhYnN0cmFjdFZpZXcuX3ZpZXdDb3VudGVyID0gMDtcclxuICAgIHJldHVybiBhYnN0cmFjdFZpZXc7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IGFic3RyYWN0VmlldztcclxuIiwidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG4gICAgfTtcclxufSkoKTtcclxuaW1wb3J0IFV0aWxzIGZyb20gJy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IEFic3RyYWN0VmlldyBmcm9tICcuL2Fic3RyYWN0Vmlldyc7XHJcbnZhciBjaGlja2VuID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgX19leHRlbmRzKGNoaWNrZW4sIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBjaGlja2VuKHBDb25maWcpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIC8vIGZvciBub3dcclxuICAgICAgICBfdGhpcy5zcHJpdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2hpY2tlbicpO1xyXG4gICAgICAgIF90aGlzLmhlbHBlckNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xyXG4gICAgICAgIF90aGlzLnNwcml0ZXMgPSB7XHJcbiAgICAgICAgICAgIHJpZ2h0OiBbXHJcbiAgICAgICAgICAgICAgICBbNjYsIDIyXSxcclxuICAgICAgICAgICAgICAgIFs5OCwgMjJdLFxyXG4gICAgICAgICAgICAgICAgWzEzMCwgMjRdLFxyXG4gICAgICAgICAgICAgICAgWzE2MiwgMjRdXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIGxlZnQ6IFtcclxuICAgICAgICAgICAgICAgIFs2NCwgOTBdLFxyXG4gICAgICAgICAgICAgICAgWzk2LCA4OV0sXHJcbiAgICAgICAgICAgICAgICBbMTI4LCA4OF0sXHJcbiAgICAgICAgICAgICAgICBbMTYwLCA4OF1cclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgZXhwbG9zaW9uOiBbXHJcbiAgICAgICAgICAgICAgICBbMjQwLCAyMl0sXHJcbiAgICAgICAgICAgICAgICBbMjA1LCAyMl0sXHJcbiAgICAgICAgICAgICAgICBbMjMsIDg3XSxcclxuICAgICAgICAgICAgICAgIFsyMywgNTZdLFxyXG4gICAgICAgICAgICAgICAgWzIzLCAyMF1cclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgX3RoaXMucGF0aCA9IFtdO1xyXG4gICAgICAgIF90aGlzLmV4cGxvZGluZyA9IGZhbHNlO1xyXG4gICAgICAgIF90aGlzLmhlbHBlckNhbnZhcy53aWR0aCA9IHBDb25maWcud2lkdGg7XHJcbiAgICAgICAgX3RoaXMuaGVscGVyQ2FudmFzLmhlaWdodCA9IHBDb25maWcuaGVpZ2h0O1xyXG4gICAgICAgIF90aGlzLnNjcmVlbiA9IHBDb25maWcuc2NyZWVuO1xyXG4gICAgICAgIF90aGlzLmhlbHBlckNvbnRleHQgPSBfdGhpcy5oZWxwZXJDYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuICAgICAgICBfdGhpcy5jdXJyZW50U3ByaXRlUG9zID0gMDtcclxuICAgICAgICB2YXIgX2JvcmRlcnMgPSBfdGhpcy5zY3JlZW4uZ2V0Qm9yZGVycygpO1xyXG4gICAgICAgIF90aGlzLmN1cnJlbnRQYXRoWCA9IFV0aWxzLmdldFJhbmRvbSgwLCBfYm9yZGVycy5yaWdodCAtIF90aGlzLmhlbHBlckNhbnZhcy53aWR0aCk7XHJcbiAgICAgICAgX3RoaXMuY3VycmVudFBhdGhZID0gVXRpbHMuZ2V0UmFuZG9tKDAsIF9ib3JkZXJzLmJvdHRvbSAtIF90aGlzLmhlbHBlckNhbnZhcy5oZWlnaHQpO1xyXG4gICAgICAgIF90aGlzLl9kcmF3Q2hpY2tlbigpO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogZ2VuZXJhdGUgdGhlIHJvdXRlXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHBGb3JjZURpcmVjdGlvblggMXwwfC0xfGZhbHNlXHJcbiAgICAgKiBAcGFyYW0gcEZvcmNlRGlyZWN0aW9uWSAxfDB8LTF8ZmFsc2VcclxuICAgICAqL1xyXG4gICAgY2hpY2tlbi5wcm90b3R5cGUuX2NyZWF0ZVBhdGggPSBmdW5jdGlvbiAocEZvcmNlRGlyZWN0aW9uWCwgcEZvcmNlRGlyZWN0aW9uWSkge1xyXG4gICAgICAgIHZhciBfcG9zU3RhcnRYID0gdGhpcy5jdXJyZW50UGF0aFgsIF9wb3NTdGFydFkgPSB0aGlzLmN1cnJlbnRQYXRoWTtcclxuICAgICAgICB0aGlzLmRpcmVjdGlvblggPSAocEZvcmNlRGlyZWN0aW9uWCAhPT0gZmFsc2UpID8gcEZvcmNlRGlyZWN0aW9uWCA6IFV0aWxzLmdldFJhbmRvbSgtMSwgMSk7XHJcbiAgICAgICAgdGhpcy5kaXJlY3Rpb25ZID0gKHBGb3JjZURpcmVjdGlvblkgIT09IGZhbHNlKSA/IHBGb3JjZURpcmVjdGlvblkgOiBVdGlscy5nZXRSYW5kb20oLTEsIDEpO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBVdGlscy5nZXRSYW5kb20oMSwgMTAwMCk7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIF9uZXh0WCA9IF9wb3NTdGFydFggKyAoX2kgKiB0aGlzLmRpcmVjdGlvblgpLCBfbmV4dFkgPSBfcG9zU3RhcnRZICsgKF9pICogdGhpcy5kaXJlY3Rpb25ZKTtcclxuICAgICAgICAgICAgdGhpcy5wYXRoLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgeDogX25leHRYLFxyXG4gICAgICAgICAgICAgICAgeTogX25leHRZLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBnZXQgbmV4dCBwYXRoIHN0ZXBcclxuICAgICAqXHJcbiAgICAgKiBjaGVjayBpZiB0aGUgc3RlcCBpcyBwb3NzaWJsZVxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm4ge3N0ZXB9XHJcbiAgICAgKi9cclxuICAgIGNoaWNrZW4ucHJvdG90eXBlLl9nZXRQYXRoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfYm9yZGVycyA9IHRoaXMuc2NyZWVuLmdldEJvcmRlcnMoKTtcclxuICAgICAgICBpZiAodGhpcy5wYXRoLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZVBhdGgoZmFsc2UsIGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIF9uZXh0U3RlcCA9IHRoaXMucGF0aC5zaGlmdCgpO1xyXG4gICAgICAgIHZhciBfZm9yY2VYID0gZmFsc2UsIF9mb3JjZVkgPSBmYWxzZTtcclxuICAgICAgICBpZiAoX25leHRTdGVwLnggPCBfYm9yZGVycy5sZWZ0KSB7XHJcbiAgICAgICAgICAgIF9mb3JjZVggPSBVdGlscy5nZXRSYW5kb20oMCwgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChfbmV4dFN0ZXAueCArIHRoaXMuaGVscGVyQ2FudmFzLndpZHRoID4gX2JvcmRlcnMucmlnaHQpIHtcclxuICAgICAgICAgICAgX2ZvcmNlWCA9IFV0aWxzLmdldFJhbmRvbSgtMSwgMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChfbmV4dFN0ZXAueSA8IF9ib3JkZXJzLnRvcCkge1xyXG4gICAgICAgICAgICBfZm9yY2VZID0gVXRpbHMuZ2V0UmFuZG9tKDAsIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoX25leHRTdGVwLnkgKyB0aGlzLmhlbHBlckNhbnZhcy5oZWlnaHQgPiBfYm9yZGVycy5ib3R0b20pIHtcclxuICAgICAgICAgICAgX2ZvcmNlWSA9IFV0aWxzLmdldFJhbmRvbSgtMSwgMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChfZm9yY2VYICE9PSBmYWxzZSB8fCBfZm9yY2VZICE9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICB0aGlzLnBhdGggPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5fY3JlYXRlUGF0aChfZm9yY2VYLCBfZm9yY2VZKTtcclxuICAgICAgICAgICAgX25leHRTdGVwID0gdGhpcy5wYXRoLnNoaWZ0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBfbmV4dFN0ZXA7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBmcmFtZSBzdGVwXHJcbiAgICAgKi9cclxuICAgIGNoaWNrZW4ucHJvdG90eXBlLnRpY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS50aWNrLmNhbGwodGhpcyk7XHJcbiAgICAgICAgdmFyIF9kcmF3ID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHRoaXMuX3RpY2tDb3VudGVyICUgMTAgPT0gMCkge1xyXG4gICAgICAgICAgICBfZHJhdyA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNwcml0ZVBvcysrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMuZXhwbG9kaW5nKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRTcHJpdGVQb3MgPj0gNCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50U3ByaXRlUG9zID0gMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFNwcml0ZVBvcyA+PSA1KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTcHJpdGVQb3MgPSAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChfZHJhdykge1xyXG4gICAgICAgICAgICB0aGlzLl9kcmF3Q2hpY2tlbigpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIGRyYXcgdGhlIGNoaWNrZW4gdG8gdGhlIGhlbHBlclxyXG4gICAgICovXHJcbiAgICBjaGlja2VuLnByb3RvdHlwZS5fZHJhd0NoaWNrZW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF9zcHJpdGU7XHJcbiAgICAgICAgaWYgKHRoaXMuZGlyZWN0aW9uWCA+PSAwKSB7XHJcbiAgICAgICAgICAgIF9zcHJpdGUgPSB0aGlzLnNwcml0ZXMucmlnaHRbdGhpcy5jdXJyZW50U3ByaXRlUG9zXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIF9zcHJpdGUgPSB0aGlzLnNwcml0ZXMubGVmdFt0aGlzLmN1cnJlbnRTcHJpdGVQb3NdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5leHBsb2RpbmcpIHtcclxuICAgICAgICAgICAgX3Nwcml0ZSA9IHRoaXMuc3ByaXRlcy5leHBsb3Npb25bdGhpcy5jdXJyZW50U3ByaXRlUG9zXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5oZWxwZXJDb250ZXh0LmNsZWFyUmVjdCgwLCAwLCB0aGlzLmhlbHBlckNhbnZhcy53aWR0aCwgdGhpcy5oZWxwZXJDYW52YXMuaGVpZ2h0KTtcclxuICAgICAgICB0aGlzLmhlbHBlckNvbnRleHQuZHJhd0ltYWdlKHRoaXMuc3ByaXRlLCBfc3ByaXRlWzBdICogLTEsIF9zcHJpdGVbMV0gKiAtMSk7XHJcbiAgICB9O1xyXG4gICAgY2hpY2tlbi5wcm90b3R5cGUuZXhwbG9kZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRTcHJpdGVQb3MgPSAwO1xyXG4gICAgICAgIHRoaXMuZXhwbG9kaW5nID0gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBjaGlja2VuLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF9jaGlja2VuID0gdGhpcy5oZWxwZXJDYW52YXM7XHJcbiAgICAgICAgdmFyIF9wYXRoID0gdGhpcy5fZ2V0UGF0aCgpO1xyXG4gICAgICAgIGlmICghdGhpcy5leHBsb2RpbmcpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGF0aFggPSBfcGF0aC54O1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRQYXRoWSA9IF9wYXRoLnk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmV4cGxvZGluZyAmJiB0aGlzLmN1cnJlbnRTcHJpdGVQb3MgPT0gNCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGltZzogX2NoaWNrZW4sXHJcbiAgICAgICAgICAgIHg6IHRoaXMuY3VycmVudFBhdGhYLFxyXG4gICAgICAgICAgICB5OiB0aGlzLmN1cnJlbnRQYXRoWSxcclxuICAgICAgICAgICAgd2lkdGg6IHRoaXMuaGVscGVyQ2FudmFzLndpZHRoLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IHRoaXMuaGVscGVyQ2FudmFzLmhlaWdodCxcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBjaGlja2VuO1xyXG59KEFic3RyYWN0VmlldykpO1xyXG5leHBvcnQgZGVmYXVsdCBjaGlja2VuO1xyXG47XHJcbiIsInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbmltcG9ydCBBYnN0cmFjdFZpZXcgZnJvbSAnLi9hYnN0cmFjdFZpZXcnO1xyXG52YXIgU2NyZWVuID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgX19leHRlbmRzKFNjcmVlbiwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFNjcmVlbihwV2lkdGgsIHBIZWlnaHQsIHBTY3JlZW5EZXN0KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5jaGlja2VucyA9IFtdO1xyXG4gICAgICAgIF90aGlzLmNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xyXG4gICAgICAgIF90aGlzLmNhbnZhcy5oZWlnaHQgPSBwV2lkdGg7XHJcbiAgICAgICAgX3RoaXMuY2FudmFzLndpZHRoID0gcEhlaWdodDtcclxuICAgICAgICBfdGhpcy5jb250ZXh0ID0gX3RoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJyk7XHJcbiAgICAgICAgX3RoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5odW50KGUpOyB9KTtcclxuICAgICAgICBwU2NyZWVuRGVzdC5hcHBlbmRDaGlsZChfdGhpcy5nZXQoKSk7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBjbGVhciBzY3JlZW4gZm9yIG5leHQgZHJhd1xyXG4gICAgICovXHJcbiAgICBTY3JlZW4ucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5jbGVhclJlY3QoMCwgMCwgdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBpbnNlcnQgdGhpbmdzL2NoaWNrZW4gdG8gc2NyZWVuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHBDaGlja2VuQ2ZnVG9JbnNlcnRcclxuICAgICAqL1xyXG4gICAgU2NyZWVuLnByb3RvdHlwZS5pbnNlcnQgPSBmdW5jdGlvbiAocENoaWNrZW4pIHtcclxuICAgICAgICB0aGlzLmNoaWNrZW5zLnB1c2gocENoaWNrZW4pO1xyXG4gICAgfTtcclxuICAgIFNjcmVlbi5wcm90b3R5cGUudGljayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX2NoaWNrZW5zVG9SZW1vdmUgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgdGhpcy5jaGlja2Vucy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIF9jaGlja2VuID0gdGhpcy5jaGlja2Vuc1tfaV07XHJcbiAgICAgICAgICAgIF9jaGlja2VuLnRpY2soKTtcclxuICAgICAgICAgICAgdmFyIF9jaGlja2VuQ2ZnID0gX2NoaWNrZW4uZ2V0KCk7XHJcbiAgICAgICAgICAgIGlmIChfY2hpY2tlbkNmZyAhPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dC5kcmF3SW1hZ2UoX2NoaWNrZW5DZmcuaW1nLCBfY2hpY2tlbkNmZy54LCBfY2hpY2tlbkNmZy55KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIF9jaGlja2Vuc1RvUmVtb3ZlLnB1c2goX2kpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2hpY2tlbnMgPSB0aGlzLmNoaWNrZW5zLmZpbHRlcihmdW5jdGlvbiAodmFsdWUsIGluZGV4KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfY2hpY2tlbnNUb1JlbW92ZS5pbmRleE9mKGluZGV4KSA9PSAtMTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKi9cclxuICAgIFNjcmVlbi5wcm90b3R5cGUuZ2V0Qm9yZGVycyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB0b3A6IDAsXHJcbiAgICAgICAgICAgIGxlZnQ6IDAsXHJcbiAgICAgICAgICAgIGJvdHRvbTogdGhpcy5jYW52YXMuaGVpZ2h0LFxyXG4gICAgICAgICAgICByaWdodDogdGhpcy5jYW52YXMud2lkdGhcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIFNjcmVlbi5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNhbnZhcztcclxuICAgIH07XHJcbiAgICBTY3JlZW4ucHJvdG90eXBlLmh1bnQgPSBmdW5jdGlvbiAocEV2ZW50KSB7XHJcbiAgICAgICAgdmFyIF9wb3NYID0gcEV2ZW50LnBhZ2VYLCBfcG9zWSA9IHBFdmVudC5wYWdlWTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgdGhpcy5jaGlja2Vucy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIF9jaGlja2VuID0gdGhpcy5jaGlja2Vuc1tfaV0sIF9jaGlja2VuQ2ZnID0gX2NoaWNrZW4uZ2V0KCk7XHJcbiAgICAgICAgICAgIGlmICghX2NoaWNrZW5DZmcpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBfaG9yaXpvbnRhbE1hdGNoID0gZmFsc2UsIF92ZXJ0aWNhbE1hdGNoID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmIChfY2hpY2tlbkNmZy54IDwgX3Bvc1ggJiYgX2NoaWNrZW5DZmcueCArIF9jaGlja2VuQ2ZnLndpZHRoID4gX3Bvc1gpIHtcclxuICAgICAgICAgICAgICAgIF9ob3Jpem9udGFsTWF0Y2ggPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChfY2hpY2tlbkNmZy55IDwgX3Bvc1kgJiYgX2NoaWNrZW5DZmcueSArIF9jaGlja2VuQ2ZnLmhlaWdodCA+IF9wb3NZKSB7XHJcbiAgICAgICAgICAgICAgICBfdmVydGljYWxNYXRjaCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKF9ob3Jpem9udGFsTWF0Y2ggJiYgX3ZlcnRpY2FsTWF0Y2gpIHtcclxuICAgICAgICAgICAgICAgIF9jaGlja2VuLmV4cGxvZGUoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBTY3JlZW47XHJcbn0oQWJzdHJhY3RWaWV3KSk7XHJcbmV4cG9ydCBkZWZhdWx0IFNjcmVlbjtcclxuIiwiaW1wb3J0IENmZyBmcm9tICcuL2NmZy9jZmcnO1xyXG5pbXBvcnQgQ2hpY2tlbiBmcm9tICcuL3ZpZXcvY2hpY2tlbic7XHJcbmltcG9ydCBTY3JlZW4gZnJvbSAnLi92aWV3L3NjcmVlbic7XHJcbnZhciBzcHJpdGVTaXplID0gMzE7XHJcbnZhciBzY3JlZW47XHJcbnZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgc2NyZWVuID0gbmV3IFNjcmVlbig1MDAsIDUwMCwgZG9jdW1lbnQuYm9keSk7XHJcbiAgICBzcGF3bkNoaWNrZW4oMTApO1xyXG4gICAgbG9vcCgpO1xyXG59O1xyXG5mdW5jdGlvbiBzcGF3bkNoaWNrZW4ocEFtb3VudCkge1xyXG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IHBBbW91bnQ7IF9pKyspIHtcclxuICAgICAgICBzY3JlZW4uaW5zZXJ0KG5ldyBDaGlja2VuKHtcclxuICAgICAgICAgICAgd2lkdGg6IHNwcml0ZVNpemUsXHJcbiAgICAgICAgICAgIGhlaWdodDogc3ByaXRlU2l6ZSxcclxuICAgICAgICAgICAgc2NyZWVuOiBzY3JlZW5cclxuICAgICAgICB9KSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gbG9vcCgpIHtcclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTtcclxuICAgICAgICBzY3JlZW4uY2xlYXIoKTtcclxuICAgICAgICBzY3JlZW4udGljaygpO1xyXG4gICAgfSwgMTAwMCAvIENmZy5mcHMpO1xyXG59XHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgaW5pdCwgZmFsc2UpO1xyXG4iXSwic291cmNlUm9vdCI6IiJ9